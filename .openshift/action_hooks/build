#!/bin/bash
KAAZING_JMS_GATEWAY_JAR=kaazing-websocket-gateway-jms-4.0.5.tar.gz
KAAZING_JMS_GATEWAY_URL=http://kaazingcorp.cachefly.net/com/download/jms/4.0.5.359/kaazing-websocket-gateway-jms-4.0.5.tar.gz

set -x 

cd $OPENSHIFT_DATA_DIR

if [ ! -e "$KAAZING_JMS_GATEWAY_JAR" ]; then
	wget $KAAZING_JMS_GATEWAY_URL -O $KAAZING_JMS_GATEWAY_JAR

	tar xzf $KAAZING_JMS_GATEWAY_JAR
	sed -i "s/0.0.0.0/$OPENSHIFT_DIY_IP/g" apache-activemq-5.5.1/conf/*.xml

	# Edit apache-activemq-5.5.1/conf/jetty.xml, change <host> in fragment shown below:
	sed "94 a\
        <property name='host' value='$OPENSHIFT_DIY_IP' />" apache-activemq-5.5.1/conf/jetty.xml
fi

